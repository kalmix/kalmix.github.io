var Formoid=(function(){var c=("https:"==location.protocol?"https:":"http:")+"//formoid.net/api/push";function b(e,f){return new Promise(function(h,g){var i=new XMLHttpRequest();i.open(f.type,e);i.onload=function(){if(i.status!==200){return g(new Error("Incorrect server response."))}h(i.responseText)};i.onerror=function(){var j="Failed to query the server. ";if("onLine" in navigator&&!navigator.onLine){j+="No connection to the Internet."}else{j+="Check the connection and try again."}g(new Error(j))};i.send(f.data)})}var d=function(f,e){f="__"+f+"__";if(e.length){this[f]=e[0];return this}return this[f]};var a=function(e){e=e||{};this.__email__=e.email||"";this.__title__=e.title||"";this.__data__=e.data||[]};a.prototype.email=function(e){return d.call(this,"email",arguments)};a.prototype.title=function(e){return d.call(this,"title",arguments)};a.prototype.data=function(e){return d.call(this,"data",arguments)};a.prototype.send=function(e){return b(c,{type:"POST",data:JSON.stringify({email:this.__email__,form:{title:this.__title__,data:(arguments.length?e:this.__data__)}})}).then(function(g){try{var f=JSON.parse(g);if(f.error){throw new Error(f.error)}return f.response}catch(h){throw new Error("Incorrect server response.")}})};return{Form:function(e){return new a(e)}}})();var isValidEmail=function(a){return a.value?/^([^@]+?)@(([a-z0-9]-*)*[a-z0-9]+\.)+([a-z0-9]+)$/i.test(a.value):true};var formComponents=document.querySelectorAll('[data-form-type="formoid"]');formComponents.forEach(function(b){var f,d=b.tagName==="FORM"?b:b.querySelector("form"),h=b.querySelector("[data-form-alert]"),g=b.getAttribute("data-form-title")?b:b.querySelector("[data-form-title]"),e=b.querySelector('[type="submit"]'),c=b.querySelectorAll("[data-form-field]"),a=h.innerHTML;d.addEventListener("change",function(i){if(i.target.type==="file"){if(i.target.files[0].size>1000000){h.removeAttribute("hidden");h.classList.remove("alert-success");h.classList.add("alert-danger");h.innerHTML="File size must be less than 1mb";e.classList.add("btn-loading");e.setAttribute("disabled",true)}}});d.addEventListener("submit",function(j){j.stopPropagation();j.preventDefault();if(e.classList.contains("btn-loading")){return}var i=c;d.classList.add("form-active");e.classList.add("btn-loading");e.setAttribute("disabled",true);h.innerHTML="";f=f||Formoid.Form({email:b.querySelector("[data-form-email]").value,title:g.getAttribute("data-form-title")||g.innerText});function k(l){return new Promise(function(q,p){if(l.getAttribute("name")==="email"&&!isValidEmail(l)){return p(new Error("Form is not valid"))}var n=l.getAttribute("data-form-field")||l.getAttribute("name");switch(l.getAttribute("type")){case"file":var o=l.files[0];if(!o){return q()}var m=new FileReader();m.onloadend=function(){q([n,m.result])};m.onerror=function(){p(m.error)};m.readAsDataURL(o);break;case"checkbox":q([n,l.checked?l.value:"No"]);break;case"radio":q(l.checked&&[n,l.value]);break;default:q([n,l.value])}})}Promise.all(Array.prototype.map.call(i,function(l){return k(l)})).then(function(l){return f.send(l.filter(function(m){return m}))}).then(function(l){d.reset();d.classList.remove("form-active");h.innerText=a||l;h.classList.remove("alert-danger");h.classList.add("alert-success")},function(l){h.innerText=l.message;h.classList.remove("alert-success");h.classList.add("alert-danger")}).then(function(){e.classList.remove("btn-loading");e.removeAttribute("disabled");h.removeAttribute("hidden")})});c.forEach(function(i){i.addEventListener("focus",function(){h.setAttribute("hidden","hidden");h.classList.add("alert-success");h.classList.remove("alert-danger");h.innerHTML="";e.classList.remove("btn-loading");e.removeAttribute("disabled")})})});
